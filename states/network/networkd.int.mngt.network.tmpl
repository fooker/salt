### This file is managed by saltstack - any changes will be overwritten ###

[Match]
Name=int.mngt


[Network]
Address={{ pillar['addresses'][grains['id']]['int']['mngt']['ip4'] }}/{{ pillar['networks']['mngt']['ip4']['netmask'] }}
Address={{ pillar['addresses'][grains['id']]['int']['mngt']['ip6'] }}/{{ pillar['networks']['mngt']['ip6']['netmask'] }}

{% if grains['role'] == 'gateway' -%}
Address=fe80::1/64
{%- endif %}

{% if grains['role'] != 'gateway' and 'ext' not in pillar['addresses'][grains['id']] -%}
Gateway={{ pillar['networks']['mngt']['ip4']['gateway'] }}
Gateway={{ pillar['networks']['mngt']['ip6']['gateway'] }}
{%- endif %}

{% if grains['role'] == 'gateway' -%}
IPForward=true
{%- endif %}

{% if 'ext' not in pillar['addresses'][grains['id']] or grains['role'] == 'gateway' -%}
DNS={{ pillar['networks']['mngt']['ip4']['gateway'] }}
DNS={{ pillar['networks']['mngt']['ip6']['gateway'] }}
{%- endif %}
